# 第16章

## アーキテクチャ

本に書いてあることを少し前の歴史から再構築してみた。

- クラサバ
  - クライアント(Windows GUIアプリ) - サーバ(DB) モデル
  - GUIアプリからDBに直接接続してSQLを投げる
  - サーバといいつつ、実質DBの事。サーバ側で何かロジック実装したいときは、ストアドを使う。
  - = 本で言うクライアントサイド中心
  - Webブラウザ時代では Java アプレット, Flash
  - 今風に言うと SPA + クラウドDB(FireBaseなど)。MRPがそういうアーキテクチャだった。ただしサーバロジックも一応あるので変則的な構成。
- ３階層モデル
  - クライアント(ビュー) - サーバ(業務ロジック) - DB
  - = 本で言うサーバサイド中心
  - Webブラウザ時代に入ってからは２つの実装方式がある。
    - Windows GUI アプリ - WebAPIサーバ - DB (=本で言うJSONでやりとり。昔はCORBA, XML, SOAP, RPCなど)
    - Webブラウザ- Webサーバアプリ - DB (=本でいうHTMLでやりとり)
  - HTMLでやりとりする方式がシンプルで分かりやすく、サーバ側の更新だけでバージョンアップ出来るので大流行。 -> MVCモデルに進化。
- Microsoft WebForms
  - Windows GUIアプリのような考え方で Web画面を制御できる。
  - 完全に Microsoft 独自のアーキテクチャ。VB, C# 専用。
  - GUIアプリ開発者には分かりやすいが、Web業界の人には変態的すぎて受け入れられず。

**Opal**

久しぶりに聞いた。
WebAssembly が完成してから流れが変わったはず。
今となっては、実用性はない。

> 一般論として、クライアントサイド中心の設計における実装 の手間は、似たような内容をサーバーサイド中心の設計で実装するのに比べ、少なく 見積もっても 2 倍にはなるでしょう。

僕もそう思います。

## フレームワーク選定

ライブラリアンとしては、それぞれの長所、短所を押さえておく必要あり。

### Rails

- フルスタック。
- 一番の知名度。情報が多い。ライブラリが多い。
- 設定よりも規約（CoC）。最初は Java Servlet と対比してよく意識された言葉だったが、最近はあまり言われなくなった。
- でも生産性に直結する重要なコンセプト。
- レールに乗ると高速に開発できる。
- 巨大で複雑。学習コストがかかる。

### Sinatra

- ２番目に有名。シンプル派。
- 機能が少ない。DBアクセス, メール送信、ファイルアップロードなどは外部ライブラリを導入して自力で！
- 小規模向け。シンプルサイト向け。

### Grape

知らなかった。
- REST風APIサーバ。
- APIドキュメント生成、バリデーション、方変換、多様なコンテンツタイプの対応など、APIサーバとして豊富な機能がある。
- Railsよりも動作が遅い。

### Roda

知らなかった。
- 豊富な機能にSinatraの使いやすさを組み合わせ。
- ルーティングとリクエストが統合されている。
  - 一枚岩的な感じにならないのかな？
  - 処理を共通化できるとのころだが、分離してあっても、mixin を使えば共通化できる。
  - プラグインが用意されている。メール送信、アセットパッケージングなど
- 無名。詳しいエンジニアがいない。

## URLパスの設計

- フラットアプローチ
- ネストアプリーチ

「一般的にはネストアプローチ」

## アーキテクチャ

- モノリス
- マイクロサービス
- アイランドチェーン

TODO


## まとめ

TODO
