**方針**
> - 読んでないところ、わからないところは「TODO」残す
> - 質問が来そうなところは、先回りして説明コードを書いてみる
> - 読み方
>   - 各節の末尾に まとめが書いてあるので、そこを読んでいく。
>   - 詳しく知りたい内容だったら、本文を読む。
>   - 上から順に読まない。
> - アウトプット
>   - 知らなかったことをまとめて書き出す。
>   - 不明点（調査項目）
>   - みんなに質問したいこと
>   - 自分で追加調査したいこと

# 第13章 デザインパターン

### 13.1.1 Object pool
内部の話。ライブラリやフレームワークの開発時に考慮が必要。

アプリ開発では、キャッシュとか？

### 13.1.2 Prototype
JavaScriptの世界。

特異クラスを使えば、Rubyでもプロトタイプベースのオブジェクトシステムを使える。

```rb
foo_proto = Object.new
foo_proto.define_singleton_method(:bar) do
  2
end

foo_clone = foo_proto.clone
foo_clone.bar # => 2
```

`Hash` の要素にラムダ式（クロージャ）を入れていくやり方もありそう。
- `v = obj[:get_value].call` みたいな書き方になる
- メソッド呼び出し時に存在チェックがない（素直に `NoMethodError` にならず、`Nil class に call() なんてんてないよ` みたいになりそう）
- ActiveSupport 拡張を使えばメソッドぽく書けるかも

**特異クラスの説明**
- 特異クラスは、そのインスタンス専用のスーパークラス。および継承ツリー。
- 特異クラスは、どんなインスタンスにも最初から存在しているのではない。
  特異クラスは、オープンするもの。
- オープンすると、その瞬間にそのインスタンスの特異クラスが出来る
  -> 元の継承ツリーから、スーパークラスがクローンされて専用のスーパークラスが出来る
- 特異クラスにメソッドを定義することで、そのインスタンスだけにメソッドを生やすことができる。＝特異メソッド
- 特異クラスのさらに特異クラスをオープンし、そこにメソッドを定義することで、そのインスタンスだけにクラスメソッドを生やすことができる。

クラスを new することでインスタンスがいくつもできるように、
スーパークラスを open することで特異クラスができる。関係が似ているかも。

### 13.1.3 Private Class Data

`private_class_method` しらんかった。
サブクラスから呼び出せるってことは、`proteced` と同じ？

`private_const` もある。
こちらもサブクラスから参照できる。やはり `protected` ですね。

### 13.1.4 Proxyパターン
代理人。
メトリクスを追加できるとあるが、それはデコレータパターン。
Proxyパターンは、本人の代わりに代理人が応答するようなやつ。本人を呼び出すととてつもなくコストがかかる場合などに使う。

とは言っても自分もアダプタパターンとデコレータとプロキシーをごっちゃにして使っていた。
デザパタ勉強会のおかげ。

`fowardable` ライブラリしらんかった。
Rails やってる人だと ActiveSupport の `delegate` の方が馴染みがある。

こういうのを使うと、継承関係を包含関係に置換して委譲関係にできる。

## 13.2 １つだけあれば良い
シングルトン？

## 13.3 なにもない
ヌルオブジェクト？

## 13.4 Visitor
TODO

## 13.5 
TODO


